# BUILD STAGE

FROM node:16-alpine3.18 as BUILD_IMAGE
WORKDIR /app/wcg
COPY package.json .
RUN yarn install
COPY . .
ENV VITE_WCG_TOKEN_ADDRESS=0xc901A057a9037c3768090CEF25Dbbc9f06A23d32
ENV VITE_WCG_POOL_ICHI=0xD49d5d18C160711Ac725112c62457338C37c30F4
ENV VITE_WCG_POOL_NI=0x4b2aE598B7423a3F581D6E7DcAa7BEE30c7acfD4
RUN yarn build

# PRODUCTION STAGE

FROM nginx:alpine3.18 as PRODUCTION_IMAGE
COPY --from=BUILD_IMAGE /app/wcg/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
ENV VITE_WCG_TOKEN_ADDRESS=0xc901A057a9037c3768090CEF25Dbbc9f06A23d32
ENV VITE_WCG_POOL_ICHI=0xD49d5d18C160711Ac725112c62457338C37c30F4
ENV VITE_WCG_POOL_NI=0x4b2aE598B7423a3F581D6E7DcAa7BEE30c7acfD4
EXPOSE 80
